{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/Ryan/Documents/GitHub/PaperHands/page/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Ryan/Documents/GitHub/PaperHands/page/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\Ryan\\\\Documents\\\\GitHub\\\\PaperHands\\\\page\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect}from\"react\";import{BrowserRouter as Router,Route,Routes}from\"react-router-dom\";import styles from\"./App.module.css\";import{Login,Register,NotFound,PageTemplate}from\"./components\";import UserContext from\"./context/UserContext\";import Axios from\"axios\";import config from\"./config/Config\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useState=useState({token:undefined,user:undefined}),_useState2=_slicedToArray(_useState,2),userData=_useState2[0],setUserData=_useState2[1];useEffect(function(){var checkLoggedIn=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var token,headers,tokenIsValid,userRes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:token=localStorage.getItem(\"auth-token\");if(!(token==null)){_context.next=6;break;}localStorage.setItem(\"auth-token\",\"\");token=\"\";setUserData({token:undefined,user:undefined});return _context.abrupt(\"return\");case 6:headers={\"x-auth-token\":token};_context.next=9;return Axios.post(config.base_url+\"/api/auth/validate\",null,{headers:headers});case 9:tokenIsValid=_context.sent;if(!tokenIsValid.data){_context.next=17;break;}_context.next=13;return Axios.get(config.base_url+\"/api/auth/user\",{headers:headers});case 13:userRes=_context.sent;setUserData({token:token,user:userRes.data});_context.next=18;break;case 17:setUserData({token:undefined,user:undefined});case 18:case\"end\":return _context.stop();}}},_callee);}));return function checkLoggedIn(){return _ref.apply(this,arguments);};}();checkLoggedIn();},[]);return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(UserContext.Provider,{value:{userData:userData,setUserData:setUserData},children:/*#__PURE__*/_jsx(\"div\",{className:styles.container,children:/*#__PURE__*/_jsxs(Routes,{children:[userData.user?/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(PageTemplate,{})}):/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Register,{})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:/*#__PURE__*/_jsx(Register,{})}),/*#__PURE__*/_jsx(Route,{element:/*#__PURE__*/_jsx(NotFound,{})})]})})})});}export default App;","map":{"version":3,"sources":["C:/Users/Ryan/Documents/GitHub/PaperHands/page/client/src/App.js"],"names":["React","useState","useEffect","BrowserRouter","Router","Route","Routes","styles","Login","Register","NotFound","PageTemplate","UserContext","Axios","config","App","token","undefined","user","userData","setUserData","checkLoggedIn","localStorage","getItem","setItem","headers","post","base_url","tokenIsValid","data","get","userRes","container"],"mappings":"8hBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,aAAa,GAAIC,CAAAA,MAA1B,CAAkCC,KAAlC,CAAyCC,MAAzC,KAAuD,kBAAvD,CACA,MAAOC,CAAAA,MAAP,KAAmB,kBAAnB,CACA,OAASC,KAAT,CAAgBC,QAAhB,CAA0BC,QAA1B,CAAoCC,YAApC,KAAwD,cAAxD,CACA,MAAOC,CAAAA,WAAP,KAAwB,uBAAxB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,iBAAnB,C,wFAEA,QAASC,CAAAA,GAAT,EAAe,CACb,cAAgCd,QAAQ,CAAC,CACvCe,KAAK,CAAEC,SADgC,CAEvCC,IAAI,CAAED,SAFiC,CAAD,CAAxC,wCAAOE,QAAP,eAAiBC,WAAjB,eAMAlB,SAAS,CAAC,UAAM,CACd,GAAMmB,CAAAA,aAAa,0FAAG,0KAChBL,KADgB,CACRM,YAAY,CAACC,OAAb,CAAqB,YAArB,CADQ,MAEhBP,KAAK,EAAI,IAFO,0BAGlBM,YAAY,CAACE,OAAb,CAAqB,YAArB,CAAmC,EAAnC,EACAR,KAAK,CAAG,EAAR,CACAI,WAAW,CAAC,CAAEJ,KAAK,CAAEC,SAAT,CAAoBC,IAAI,CAAED,SAA1B,CAAD,CAAX,CALkB,wCASdQ,OATc,CASJ,CACd,eAAgBT,KADF,CATI,uBAaOH,CAAAA,KAAK,CAACa,IAAN,CACzBZ,MAAM,CAACa,QAAP,CAAkB,oBADO,CAEzB,IAFyB,CAGzB,CACEF,OAAO,CAAPA,OADF,CAHyB,CAbP,QAadG,YAbc,mBAqBhBA,YAAY,CAACC,IArBG,iDAsBIhB,CAAAA,KAAK,CAACiB,GAAN,CAAUhB,MAAM,CAACa,QAAP,CAAkB,gBAA5B,CAA8C,CAClEF,OAAO,CAAPA,OADkE,CAA9C,CAtBJ,SAsBZM,OAtBY,eAyBlBX,WAAW,CAAC,CACVJ,KAAK,CAALA,KADU,CAEVE,IAAI,CAAEa,OAAO,CAACF,IAFJ,CAAD,CAAX,CAzBkB,+BA8BlBT,WAAW,CAAC,CAAEJ,KAAK,CAAEC,SAAT,CAAoBC,IAAI,CAAED,SAA1B,CAAD,CAAX,CA9BkB,uDAAH,kBAAbI,CAAAA,aAAa,0CAAnB,CAkCAA,aAAa,GACd,CApCQ,CAoCN,EApCM,CAAT,CAwCA,mBACE,KAAC,MAAD,wBACE,KAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,CAAE,CAAEF,QAAQ,CAARA,QAAF,CAAYC,WAAW,CAAXA,WAAZ,CAA7B,uBACE,YAAK,SAAS,CAAEb,MAAM,CAACyB,SAAvB,uBACE,MAAC,MAAD,YACGb,QAAQ,CAACD,IAAT,cACC,KAAC,KAAD,EAAO,IAAI,CAAC,GAAZ,CAAgB,OAAO,cAAE,KAAC,YAAD,IAAzB,EADD,cAGC,KAAC,KAAD,EAAO,IAAI,CAAC,GAAZ,CAAgB,OAAO,cAAE,KAAC,QAAD,IAAzB,EAJJ,cAME,KAAC,KAAD,EAAO,IAAI,CAAC,QAAZ,CAAqB,OAAO,cAAE,KAAC,KAAD,IAA9B,EANF,cAOE,KAAC,KAAD,EAAO,IAAI,CAAC,WAAZ,CAAwB,OAAO,cAAE,KAAC,QAAD,IAAjC,EAPF,cAQE,KAAC,KAAD,EAAO,OAAO,cAAE,KAAC,QAAD,IAAhB,EARF,GADF,EADF,EADF,EADF,CAkBD,CAED,cAAeH,CAAAA,GAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { BrowserRouter as Router, Route, Routes } from \"react-router-dom\";\nimport styles from \"./App.module.css\";\nimport { Login, Register, NotFound, PageTemplate } from \"./components\";\nimport UserContext from \"./context/UserContext\";\nimport Axios from \"axios\";\nimport config from \"./config/Config\";\n\nfunction App() {\n  const [userData, setUserData] = useState({\n    token: undefined,\n    user: undefined,\n  });\n\n  \n  useEffect(() => {\n    const checkLoggedIn = async () => {\n      let token = localStorage.getItem(\"auth-token\");\n      if (token == null) {\n        localStorage.setItem(\"auth-token\", \"\");\n        token = \"\";\n        setUserData({ token: undefined, user: undefined });\n        return;\n      }\n\n      const headers = {\n        \"x-auth-token\": token,\n      };\n\n      const tokenIsValid = await Axios.post(\n        config.base_url + \"/api/auth/validate\",\n        null,\n        {\n          headers,\n        }\n      );\n\n      if (tokenIsValid.data) {\n        const userRes = await Axios.get(config.base_url + \"/api/auth/user\", {\n          headers,\n        });\n        setUserData({\n          token,\n          user: userRes.data,\n        });\n      } else {\n        setUserData({ token: undefined, user: undefined });\n      }\n    };\n\n    checkLoggedIn();\n  }, []); \n\n\n\n  return (\n    <Router>\n      <UserContext.Provider value={{ userData, setUserData }}>\n        <div className={styles.container}>\n          <Routes>\n            {userData.user ? (\n              <Route path=\"/\" element={<PageTemplate />} />\n            ) : (\n              <Route path=\"/\" element={<Register />} />\n            )}\n            <Route path=\"/login\" element={<Login />} />\n            <Route path=\"/register\" element={<Register />} />\n            <Route element={<NotFound />} />\n          </Routes>\n        </div>\n      </UserContext.Provider>\n    </Router>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}